<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="Qin Dazhu">





<title>Add gitalk to your blog to support comments | Dazhu&#39;s Blog</title>



    <link rel="icon" href="/favicon.ico">



<script>
    var _hmt = _hmt || [];
    (function() {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?f2cc6cb138864854619b2aa388016aab";
    var s = document.getElementsByTagName("script")[0]; 
         s.parentNode.insertBefore(hm, s);
    })();
</script>



    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    





    
    
        
    


<meta name="generator" content="Hexo 4.2.0"></head>
<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">Dazhu&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>

        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">Dazhu&#39;s Blog</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
        <div class="main">
            <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    document.ready(
        function () {
            tocbot.init({
                tocSelector: '.tocbot-list',
                contentSelector: '.post-content',
                headingSelector: 'h1, h2, h3, h4, h5',
                collapseDepth: 1,
                orderedList: false,
                scrollSmooth: true,
            })
        }
    )

    function expand_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 6,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "collapse_toc()");
        b.innerHTML = "Collapse all"
    }

    function collapse_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 1,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "expand_toc()");
        b.innerHTML = "Expand all"
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">Add gitalk to your blog to support comments</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">Qin Dazhu</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">January 23, 2020&nbsp;&nbsp;22:13:58</a>
                        </span>
                    
                </div>
                <div class="post-meta">
                    
                        <span class="post-category">
                        Category:
                            
                                <a href="/categories/Hexo/">Hexo</a>
                            
                        </span>
                    
                </div>
                <div class="post-meta">
                    <section class="post-tags">
                        <div>
                            <span>Tags:</span>
                            <span class="tag">
                            
                                
                                <a href="/tags/Hexo/">Hexo</a>
                                
                                <a href="/tags/gitalk/">gitalk</a>
                                
                                <a href="/tags/blog-comments/">blog comments</a>
                                
                            
                            </span>
                        </div>

                    </section>
                </div>
            
        </header>

        <div class="post-content">
            <p><a href="https://github.com/gitalk/gitalk" target="_blank" rel="noopener">gitalk</a> is a modern comment component based on GitHub Issue and Preact. You can integrate gitalk to your blog to support <code>comments</code>.</p>
<h2 id="Create-a-repo-on-GitHub-to-store-comments"><a href="#Create-a-repo-on-GitHub-to-store-comments" class="headerlink" title="Create a repo on GitHub to store comments"></a>Create a repo on GitHub to store comments</h2><p>For example, I create a repo named <strong>blog-comments</strong>. </p>
<p>Remember to enable <code>issues</code> in the setting page of this repo.</p>
<h2 id="Register-an-OAuth-application-on-GitHub"><a href="#Register-an-OAuth-application-on-GitHub" class="headerlink" title="Register an OAuth application on GitHub"></a>Register an OAuth application on GitHub</h2><p>This application will be used by gitalk.</p>
<p>Remember to enter you blog url in item <strong>Homepage URL</strong> and <strong>AUthorization callback URL</strong>. </p>
<p>Copy <strong>Client ID</strong> and <strong>Client Secret</strong>. You can also check your application at <a href="https://github.com/settings/developers" target="_blank" rel="noopener">https://github.com/settings/developers</a>.</p>
<h2 id="Configure-Hexo"><a href="#Configure-Hexo" class="headerlink" title="Configure Hexo"></a>Configure Hexo</h2><h3 id="Create-file-comment-ejs-in-folder-themes-me-layout-partial"><a href="#Create-file-comment-ejs-in-folder-themes-me-layout-partial" class="headerlink" title="Create file  comment.ejs in folder themes/me/layout_partial"></a>Create file  <code>comment.ejs</code> in folder <code>themes/me/layout_partial</code></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;npm&#x2F;gitalk@1&#x2F;dist&#x2F;gitalk.css&quot;&gt;</span><br><span class="line">&lt;script src&#x3D;&quot;https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;npm&#x2F;gitalk@1&#x2F;dist&#x2F;gitalk.min.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&lt;div id&#x3D;&quot;gitalk-container&quot;&gt;&lt;&#x2F;div&gt;</span><br><span class="line">&lt;script type&#x3D;&quot;text&#x2F;javascript&quot;&gt;</span><br><span class="line">    var gitalk &#x3D; new Gitalk(&#123;</span><br><span class="line">        clientID: &#39;&lt;%&#x3D; theme.gitalk.clientID %&gt;&#39;,</span><br><span class="line">        clientSecret: &#39;&lt;%&#x3D; theme.gitalk.clientSecret %&gt;&#39;,</span><br><span class="line">        id: window.location.pathname,</span><br><span class="line">        repo: &#39;&lt;%&#x3D; theme.gitalk.repo %&gt;&#39;,</span><br><span class="line">        owner: &#39;&lt;%&#x3D; theme.gitalk.owner %&gt;&#39;,</span><br><span class="line">        admin: &#39;&lt;%&#x3D; theme.gitalk.admin %&gt;&#39;</span><br><span class="line">    &#125;)</span><br><span class="line">    gitalk.render(&#39;gitalk-container&#39;)</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>
<p>Note if your theme differs mine, you may need to find proper location to store <code>comment.ejs</code>.</p>
<h3 id="Embed-comment-js-in-your-post-ejs-file"><a href="#Embed-comment-js-in-your-post-ejs-file" class="headerlink" title="Embed comment.js in your post.ejs file"></a>Embed <code>comment.js</code> in your <code>post.ejs</code> file</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;%# gitalk comments %&gt;</span><br><span class="line">   &lt;%if(theme.gitalk.enable)&#123;%&gt;</span><br><span class="line">       &lt;%- partial(&#39;_partial&#x2F;comment&#39;) %&gt;</span><br><span class="line">   &lt;%&#125;%&gt;</span><br></pre></td></tr></table></figure>
<h3 id="Configure-gitalk-parameters-in-config-yml"><a href="#Configure-gitalk-parameters-in-config-yml" class="headerlink" title="Configure gitalk parameters in _config.yml"></a>Configure gitalk parameters in <code>_config.yml</code></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># gittalk comments</span><br><span class="line">gitalk:</span><br><span class="line">  enable: true</span><br><span class="line">  owner: your-github-username # github username</span><br><span class="line">  repo: blog-comments # repo name to store comments</span><br><span class="line">  admin: your-github-username # owner of repo above</span><br><span class="line">  clientID: your-client-id  # application id and secret</span><br><span class="line">  clientSecret: your-client-secret</span><br></pre></td></tr></table></figure>

<p>After publish, you need to login with your GitHub account at the bottom of the current post, then you’ll find you (and other users) can comment your blog.  All comments will be stored under <code>issues</code> of your branch <code>blog-comments</code>.</p>

        </div>

        
            <section class="post-copyright">
                
                
                
                

            </section>
        

        

    </article>

    
    
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<div id="gitalk-container"></div>
<script type="text/javascript">
    var gitalk = new Gitalk({
        clientID: '366c14e3419153f51738',
        clientSecret: '7b9f17b0ec13ffd9fd44c85285bb57d8bcbdb3f0',
        id: window.location.pathname,
        repo: 'blog-comments',
        owner: 'qindazhu',
        admin: 'qindazhu'
    })
    gitalk.render('gitalk-container')
</script>

    

</div>

        </div>
        <footer id="footer" class="footer">
    <div class="copyright">
        <span>© Qin Dazhu | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>

    
    
    <script src="/js/canvas-nest/canvas-nest-nomobile.min.js" color="0,0,0" opacity="0.5" zIndex="-1" count="80" ></script>
    

</body>
</html>
